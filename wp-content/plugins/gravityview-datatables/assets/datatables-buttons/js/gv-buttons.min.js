!function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable,_instCounter=0,_buttonCounter=0,_dtButtons=DataTable.ext.buttons;function _fadeIn(el,duration,fn){$.fn.animate?el.stop().fadeIn(duration,fn):(el.css("display","block"),fn&&fn.call(el))}function _fadeOut(el,duration,fn){$.fn.animate?el.stop().fadeOut(duration,fn):(el.css("display","none"),fn&&fn.call(el))}function Buttons(dt,config){if(!(this instanceof Buttons))return function(settings){return new Buttons(settings,dt).container()};!0===(config=void 0===config?{}:config)&&(config={}),Array.isArray(config)&&(config={buttons:config}),this.c=$.extend(!0,{},Buttons.defaults,config),config.buttons&&(this.c.buttons=config.buttons),this.s={dt:new DataTable.Api(dt),buttons:[],listenKeys:"",namespace:"dtb"+_instCounter++},this.dom={container:$("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)},this._constructor()}var _infoTimer;$.extend(Buttons.prototype,{action:function(button,action){button=this._nodeToButton(button);return action===undefined?button.conf.action:(button.conf.action=action,this)},active:function(klass,flag){var jqNode=this._nodeToButton(klass),klass=this.c.dom.button.active,jqNode=$(jqNode.node);return flag===undefined?jqNode.hasClass(klass):(jqNode.toggleClass(klass,flag===undefined||flag),this)},add:function(config,idx,draw){var buttons=this.s.buttons;if("string"==typeof idx){for(var split=idx.split("-"),base=this.s,i=0,ien=split.length-1;i<ien;i++)base=base.buttons[+split[i]];buttons=base.buttons,idx=+split[split.length-1]}return this._expandButton(buttons,config,config!==undefined?config.split:undefined,(config===undefined||config.split===undefined||0===config.split.length)&&base!==undefined,!1,idx),draw!==undefined&&!0!==draw||this._draw(),this},collectionRebuild:function(node,newButtons){var button=this._nodeToButton(node);if(newButtons!==undefined){for(var i=button.buttons.length-1;0<=i;i--)this.remove(button.buttons[i].node);for(i=0;i<newButtons.length;i++){var newBtn=newButtons[i];this._expandButton(button.buttons,newBtn,newBtn!==undefined&&newBtn.config!==undefined&&newBtn.config.split!==undefined,!0,newBtn.parentConf!==undefined&&newBtn.parentConf.split!==undefined,i,newBtn.parentConf)}}this._draw(button.collection,button.buttons)},container:function(){return this.dom.container},disable:function(button){button=this._nodeToButton(button);return $(button.node).addClass(this.c.dom.button.disabled).attr("disabled",!0),this},destroy:function(){$("body").off("keyup."+this.s.namespace);for(var buttons=this.s.buttons.slice(),i=0,ien=buttons.length;i<ien;i++)this.remove(buttons[i].node);this.dom.container.remove();var buttonInsts=this.s.dt.settings()[0];for(i=0,ien=buttonInsts.length;i<ien;i++)if(buttonInsts.inst===this){buttonInsts.splice(i,1);break}return this},enable:function(button,flag){if(!1===flag)return this.disable(button);button=this._nodeToButton(button);return $(button.node).removeClass(this.c.dom.button.disabled).removeAttr("disabled"),this},index:function(node,nested,buttons){nested||(nested="",buttons=this.s.buttons);for(var i=0,ien=buttons.length;i<ien;i++){var match=buttons[i].buttons;if(buttons[i].node===node)return nested+i;if(match&&match.length){match=this.index(node,i+"-",match);if(null!==match)return match}}return null},name:function(){return this.c.name},node:function(button){if(!button)return this.dom.container;button=this._nodeToButton(button);return $(button.node)},processing:function(node,flag){var dt=this.s.dt,button=this._nodeToButton(node);return flag===undefined?$(button.node).hasClass("processing"):($(button.node).toggleClass("processing",flag),$(dt.table().node()).triggerHandler("buttons-processing.dt",[flag,dt.button(node),dt,$(node),button.conf]),this)},remove:function(idx){var button=this._nodeToButton(idx),host=this._nodeToHost(idx),dt=this.s.dt;if(button.buttons.length)for(var i=button.buttons.length-1;0<=i;i--)this.remove(button.buttons[i].node);button.conf.destroying=!0,button.conf.destroy&&button.conf.destroy.call(dt.button(idx),dt,$(idx),button.conf),this._removeKey(button.conf),$(button.node).remove();idx=$.inArray(button,host);return host.splice(idx,1),this},text:function(linerTag,label){var button=this._nodeToButton(linerTag),text=this.c.dom.collection.buttonLiner,linerTag=(button.inCollection&&text&&text.tag?text:this.c.dom.buttonLiner).tag,dt=this.s.dt,jqNode=$(button.node),text=function(opt){return"function"==typeof opt?opt(dt,jqNode,button.conf):opt};return label===undefined?text(button.conf.text):(button.conf.text=label,(linerTag?jqNode.children(linerTag).eq(0).filter(":not(.dt-down-arrow)"):jqNode).html(text(label)),this)},_constructor:function(){var that=this,dt=this.s.dt,dtSettings=dt.settings()[0],buttons=this.c.buttons;dtSettings._buttons||(dtSettings._buttons=[]),dtSettings._buttons.push({inst:this,name:this.c.name});for(var i=0,ien=buttons.length;i<ien;i++)this.add(buttons[i]);dt.on("destroy",function(e,settings){settings===dtSettings&&that.destroy()}),$("body").on("keyup."+this.s.namespace,function(e){var character;document.activeElement&&document.activeElement!==document.body||(character=String.fromCharCode(e.keyCode).toLowerCase(),-1!==that.s.listenKeys.toLowerCase().indexOf(character)&&that._keypress(character,e))})},_addKey:function(conf){conf.key&&(this.s.listenKeys+=($.isPlainObject(conf.key)?conf.key:conf).key)},_draw:function(container,buttons){container||(container=this.dom.container,buttons=this.s.buttons),container.children().detach();for(var i=0,ien=buttons.length;i<ien;i++)container.append(buttons[i].inserter),container.append(" "),buttons[i].buttons&&buttons[i].buttons.length&&this._draw(buttons[i].collection,buttons[i].buttons)},_expandButton:function(attachTo,button,split,inCollection,inSplit,attachPoint,parentConf){var dt=this.s.dt,isSplit=!1,buttons=Array.isArray(button)?button:[button];button===undefined&&(buttons=Array.isArray(split)?split:[split]),button!==undefined&&button.split!==undefined&&(isSplit=!0);for(var i=0,ien=buttons.length;i<ien;i++){var conf=this._resolveExtends(buttons[i]);if(conf)if(isSplit=!(conf.config===undefined||!conf.config.split),Array.isArray(conf))this._expandButton(attachTo,conf,built!==undefined&&built.conf!==undefined?built.conf.split:undefined,inCollection,parentConf!==undefined&&parentConf.split!==undefined,attachPoint,parentConf);else{var built=this._buildButton(conf,inCollection,conf.split!==undefined||conf.config!==undefined&&conf.config.split!==undefined,inSplit);if(built){if(attachPoint!==undefined&&null!==attachPoint?(attachTo.splice(attachPoint,0,built),attachPoint++):attachTo.push(built),built.conf.buttons||built.conf.split){if(built.collection=$("<"+(isSplit?this.c.dom.splitCollection:this.c.dom.collection).tag+"/>"),built.conf._collection=built.collection,built.conf.split)for(var j=0;j<built.conf.split.length;j++)"object"==typeof built.conf.split[j]&&(built.conf.split[i].parent=parentConf,built.conf.split[j].collectionLayout===undefined&&(built.conf.split[j].collectionLayout=built.conf.collectionLayout),built.conf.split[j].dropup===undefined&&(built.conf.split[j].dropup=built.conf.dropup),built.conf.split[j].fade===undefined&&(built.conf.split[j].fade=built.conf.fade));else $(built.node).append($('<span class="dt-down-arrow">'+this.c.dom.splitDropdown.text+"</span>"));this._expandButton(built.buttons,built.conf.buttons,built.conf.split,!isSplit,isSplit,attachPoint,built.conf)}built.conf.parent=parentConf,conf.init&&conf.init.call(dt.button(built.node),dt,$(built.node),conf),0}}}},_buildButton:function(config,inCollection,isSplit,inSplit){var action,clickBlurs,button,buttonDom=this.c.dom.button,linerDom=this.c.dom.buttonLiner,liner=this.c.dom.collection,splitCollectionDom=(this.c.dom.split,this.c.dom.splitCollection),splitDropdownButton=this.c.dom.splitDropdownButton,dt=this.s.dt,inserter=function(opt){return"function"==typeof opt?opt(dt,button,config):opt};if(config.spacer){var spacer=$("<span></span>").addClass("dt-button-spacer "+config.style+" "+buttonDom.spacerClass).html(inserter(config.text));return{conf:config,node:spacer,inserter:spacer,buttons:[],inCollection:inCollection,isSplit:isSplit,inSplit:inSplit,collection:null}}if(!isSplit&&inSplit&&splitCollectionDom?buttonDom=splitDropdownButton:!isSplit&&inCollection&&liner.button&&(buttonDom=liner.button),!isSplit&&inSplit&&splitCollectionDom.buttonLiner?linerDom=splitCollectionDom.buttonLiner:!isSplit&&inCollection&&liner.buttonLiner&&(linerDom=liner.buttonLiner),config.available&&!config.available(dt,config)&&!config.hasOwnProperty("html"))return!1;config.hasOwnProperty("html")?button=$(config.html):(action=function(e,dt,button,config){config.action.call(dt.button(button),e,dt,button,config),$(dt.table().node()).triggerHandler("buttons-action.dt",[dt.button(button),dt,button,config])},liner=config.tag||buttonDom.tag,clickBlurs=config.clickBlurs===undefined||config.clickBlurs,button=$("<"+liner+"/>").addClass(buttonDom.className).addClass(inSplit?this.c.dom.splitDropdownButton.className:"").attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(e){e.preventDefault(),!button.hasClass(buttonDom.disabled)&&config.action&&action(e,dt,button,config),clickBlurs&&button.trigger("blur")}).on("keypress.dtb",function(e){13===e.keyCode&&(e.preventDefault(),!button.hasClass(buttonDom.disabled)&&config.action&&action(e,dt,button,config))}),"a"===liner.toLowerCase()&&button.attr("href","#"),"button"===liner.toLowerCase()&&button.attr("type","button"),linerDom.tag?(liner=$("<"+linerDom.tag+"/>").html(inserter(config.text)).addClass(linerDom.className),"a"===linerDom.tag.toLowerCase()&&liner.attr("href","#"),button.append(liner)):button.html(inserter(config.text)),!1===config.enabled&&button.addClass(buttonDom.disabled),config.className&&button.addClass(config.className),config.titleAttr&&button.attr("title",inserter(config.titleAttr)),config.attr&&button.attr(config.attr),config.namespace||(config.namespace=".dt-button-"+_buttonCounter++),config.config!==undefined&&config.config.split&&(config.split=config.config.split));var splitDiv,dropButtonConfig,splitAction,dropButton,inserter=this.c.dom.buttonContainer,inserter=inserter&&inserter.tag?$("<"+inserter.tag+"/>").addClass(inserter.className).append(button):button;return this._addKey(config),this.c.buttonCreated&&(inserter=this.c.buttonCreated(config,inserter)),isSplit&&((splitDiv=$("<div/>").addClass(this.c.dom.splitWrapper.className)).append(button),dropButtonConfig=$.extend(config,{text:this.c.dom.splitDropdown.text,className:this.c.dom.splitDropdown.className,attr:{"aria-haspopup":!0,"aria-expanded":!1},align:this.c.dom.splitDropdown.align,splitAlignClass:this.c.dom.splitDropdown.splitAlignClass}),this._addKey(dropButtonConfig),splitAction=function(e,dt,button,config){_dtButtons.split.action.call(dt.button($("div.dt-btn-split-wrapper")[0]),e,dt,button,config),$(dt.table().node()).triggerHandler("buttons-action.dt",[dt.button(button),dt,button,config]),button.attr("aria-expanded",!0)},dropButton=$('<button class="'+this.c.dom.splitDropdown.className+' dt-button"><span class="dt-btn-split-drop-arrow">'+this.c.dom.splitDropdown.text+"</span></button>").on("click.dtb",function(e){e.preventDefault(),e.stopPropagation(),dropButton.hasClass(buttonDom.disabled)||splitAction(e,dt,dropButton,dropButtonConfig),clickBlurs&&dropButton.trigger("blur")}).on("keypress.dtb",function(e){13===e.keyCode&&(e.preventDefault(),dropButton.hasClass(buttonDom.disabled)||splitAction(e,dt,dropButton,dropButtonConfig))}),0===config.split.length&&dropButton.addClass("dtb-hide-drop"),splitDiv.append(dropButton).attr(dropButtonConfig.attr)),{conf:config,node:(isSplit?splitDiv:button).get(0),inserter:isSplit?splitDiv:inserter,buttons:[],inCollection:inCollection,isSplit:isSplit,inSplit:inSplit,collection:null}},_nodeToButton:function(node,buttons){for(var i=0,ien=(buttons=buttons||this.s.buttons).length;i<ien;i++){if(buttons[i].node===node)return buttons[i];if(buttons[i].buttons.length){var ret=this._nodeToButton(node,buttons[i].buttons);if(ret)return ret}}},_nodeToHost:function(node,buttons){for(var i=0,ien=(buttons=buttons||this.s.buttons).length;i<ien;i++){if(buttons[i].node===node)return buttons;if(buttons[i].buttons.length){var ret=this._nodeToHost(node,buttons[i].buttons);if(ret)return ret}}},_keypress:function(character,e){var recurse;e._buttonsHandled||(recurse=function(a){for(var conf,node,i=0,ien=a.length;i<ien;i++)conf=a[i].conf,node=a[i].node,conf.key&&(conf.key===character?(e._buttonsHandled=!0,$(node).click()):$.isPlainObject(conf.key)&&conf.key.key===character&&(conf.key.shiftKey&&!e.shiftKey||conf.key.altKey&&!e.altKey||conf.key.ctrlKey&&!e.ctrlKey||conf.key.metaKey&&!e.metaKey||(e._buttonsHandled=!0,$(node).click()))),a[i].buttons.length&&recurse(a[i].buttons)})(this.s.buttons)},_removeKey:function(a){var idx;a.key&&(idx=($.isPlainObject(a.key)?a.key:a).key,a=this.s.listenKeys.split(""),idx=$.inArray(idx,a),a.splice(idx,1),this.s.listenKeys=a.join(""))},_resolveExtends:function(conf){function toConfObject(base){for(var loop=0;!$.isPlainObject(base)&&!Array.isArray(base);){if(base===undefined)return;if("function"==typeof base){if(!(base=base.call(that,dt,conf)))return!1}else if("string"==typeof base){if(!_dtButtons[base])return{html:base};base=_dtButtons[base]}if(30<++loop)throw"Buttons: Too many iterations"}return Array.isArray(base)?base:$.extend({},base)}var i,ien,that=this,dt=this.s.dt;for(conf=toConfObject(conf);conf&&conf.extend;){if(!_dtButtons[conf.extend])throw"Cannot extend unknown button type: "+conf.extend;var objArray=toConfObject(_dtButtons[conf.extend]);if(Array.isArray(objArray))return objArray;if(!objArray)return!1;var originalClassName=objArray.className;conf.config!==undefined&&objArray.config!==undefined&&(conf.config=$.extend({},objArray.config,conf.config)),conf=$.extend({},objArray,conf),originalClassName&&conf.className!==originalClassName&&(conf.className=originalClassName+" "+conf.className);var postfixButtons=conf.postfixButtons;if(postfixButtons){for(conf.buttons||(conf.buttons=[]),i=0,ien=postfixButtons.length;i<ien;i++)conf.buttons.push(postfixButtons[i]);conf.postfixButtons=null}var prefixButtons=conf.prefixButtons;if(prefixButtons){for(conf.buttons||(conf.buttons=[]),i=0,ien=prefixButtons.length;i<ien;i++)conf.buttons.splice(i,0,prefixButtons[i]);conf.prefixButtons=null}conf.extend=objArray.extend}return conf},_popover:function(content,buttonsLeft,tableLeft,e){function close(){closed=!0,_fadeOut($(".dt-button-collection"),options.fade,function(){$(this).detach()}),$(dt.buttons('[aria-haspopup="true"][aria-expanded="true"]').nodes()).attr("aria-expanded","false"),$("div.dt-button-background").off("click.dtb-collection"),Buttons.background(!1,options.backgroundClassName,options.fade,hostNode),$("body").off(".dtb-collection"),dt.off("buttons-action.b-internal"),dt.off("destroy")}var display,tableRight,popoverRight,buttonsRight,splitButtonLeft,splitButtonRight,leftGap,rightGap,popoverShuffle,top,dt=buttonsLeft,popoverLeft=this.c,closed=!1,options=$.extend({align:"button-left",autoClose:!1,background:!0,backgroundClassName:"dt-button-background",contentClassName:popoverLeft.dom.collection.className,collectionLayout:"",collectionTitle:"",dropup:!1,fade:400,popoverTitle:"",rightAlignClassName:"dt-button-right",splitRightAlignClassName:"dt-button-split-right",splitLeftAlignClassName:"dt-button-split-left",tag:popoverLeft.dom.collection.tag},tableLeft),hostNode=buttonsLeft.node();!1!==content?((popoverRight=$(dt.buttons('[aria-haspopup="true"][aria-expanded="true"]').nodes())).length&&(hostNode.closest("div.dt-button-collection").length&&(hostNode=popoverRight.eq(0)),close()),display=$("<div/>").addClass("dt-button-collection").addClass(options.collectionLayout).addClass(options.splitAlignClass).css("display","none"),content=$(content).addClass(options.contentClassName).attr("role","menu").appendTo(display),hostNode.attr("aria-expanded","true"),hostNode.parents("body")[0]!==document.body&&(hostNode=document.body.lastChild),options.popoverTitle?display.prepend('<div class="dt-button-collection-title">'+options.popoverTitle+"</div>"):options.collectionTitle&&display.prepend('<div class="dt-button-collection-title">'+options.collectionTitle+"</div>"),_fadeIn(display.insertAfter(hostNode),options.fade),buttonsRight=$(buttonsLeft.table().container()),splitButtonLeft=display.css("position"),"dt-container"===options.align&&(hostNode=hostNode.parent(),display.css("width",buttonsRight.width())),"absolute"===splitButtonLeft?(splitButtonRight=hostNode.position(),tableRight=$(buttonsLeft.node()).position(),display.css({top:$($(buttonsLeft[0].node).parent()[0]).hasClass("dt-buttons")?tableRight.top+hostNode.outerHeight():splitButtonRight.top+hostNode.outerHeight(),left:splitButtonRight.left}),popoverLeft=display.outerHeight(),tableLeft=buttonsRight.offset().top+buttonsRight.height(),popoverRight=tableRight.top+hostNode.outerHeight()+popoverLeft-tableLeft,splitButtonLeft=tableRight.top-popoverLeft,buttonsLeft=buttonsRight.offset().top,splitButtonRight=tableRight.top-popoverLeft-5,(buttonsLeft-splitButtonLeft<popoverRight||options.dropup)&&-splitButtonRight<buttonsLeft&&display.css("top",splitButtonRight),tableRight=(tableLeft=buttonsRight.offset().left)+buttonsRight.width(),popoverRight=(popoverLeft=display.offset().left)+(splitButtonLeft=0===(splitButtonLeft=display.outerWidth())&&0<display.children().length?$(display.children()[0]).outerWidth():splitButtonLeft),buttonsRight=(buttonsLeft=hostNode.offset().left)+(splitButtonRight=hostNode.outerWidth()),display.hasClass(options.rightAlignClassName)||display.hasClass(options.leftAlignClassName)||display.hasClass(options.splitAlignClass)||"dt-container"===options.align?(splitButtonLeft=buttonsLeft,splitButtonRight=buttonsRight,hostNode.hasClass("dt-btn-split-wrapper")&&0<hostNode.children("button.dt-btn-split-drop").length&&(splitButtonRight=(splitButtonLeft=hostNode.children("button.dt-btn-split-drop").offset().left)+hostNode.children("button.dt-btn-split-drop").outerWidth()),popoverShuffle=0,display.hasClass(options.rightAlignClassName)?popoverLeft+(popoverShuffle=buttonsRight-popoverRight)<tableLeft&&(popoverShuffle+=(rightGap=tableRight-(popoverRight+popoverShuffle))<(leftGap=tableLeft-(popoverLeft+popoverShuffle))?rightGap:leftGap):display.hasClass(options.splitRightAlignClassName)?popoverLeft+(popoverShuffle=splitButtonRight-popoverRight)<tableLeft&&(popoverShuffle+=(rightGap=tableRight-(popoverRight+popoverShuffle))<(leftGap=tableLeft-(popoverLeft+popoverShuffle))?rightGap:leftGap):display.hasClass(options.splitLeftAlignClassName)?(tableRight<popoverRight+(popoverShuffle=splitButtonLeft-popoverLeft)||popoverLeft+popoverShuffle<tableLeft)&&(popoverShuffle+=(rightGap=tableRight-(popoverRight+popoverShuffle))<(leftGap=tableLeft-(popoverLeft+popoverShuffle))?rightGap:leftGap):tableRight<popoverRight+(popoverShuffle=tableLeft-popoverLeft)&&(popoverShuffle+=(rightGap=tableRight-(popoverRight+popoverShuffle))<(leftGap=tableLeft-(popoverLeft+popoverShuffle))?rightGap:leftGap)):(top=hostNode.offset().top,popoverShuffle=0,popoverShuffle="button-right"===options.align?buttonsRight-popoverRight:buttonsLeft-popoverLeft),display.css("left",display.position().left+popoverShuffle)):((top=display.height()/2)>$(window).height()/2&&(top=$(window).height()/2),display.css("marginTop",-1*top)),options.background&&Buttons.background(!0,options.backgroundClassName,options.fade,options.backgroundHost||hostNode),$("div.dt-button-background").on("click.dtb-collection",function(){}),options.autoClose&&setTimeout(function(){dt.on("buttons-action.b-internal",function(e,btn,dt,node){node[0]!==hostNode[0]&&close()})},0),$(display).trigger("buttons-popover.dt"),dt.on("destroy",close),setTimeout(function(){closed=!1,$("body").on("click.dtb-collection",function(e){var back,parent;closed||(back=$.fn.addBack?"addBack":"andSelf",parent=$(e.target).parent()[0],($(e.target).parents()[back]().filter(content).length||$(parent).hasClass("dt-buttons"))&&!$(e.target).hasClass("dt-button-background")||close())}).on("keyup.dtb-collection",function(e){27===e.keyCode&&close()})},0)):close()}}),Buttons.background=function(show,className,fade,insertPoint){fade===undefined&&(fade=400),insertPoint=insertPoint||document.body,show?_fadeIn($("<div/>").addClass(className).css("display","none").insertAfter(insertPoint),fade):_fadeOut($("div."+className),fade,function(){$(this).removeClass(className).remove()})},Buttons.instanceSelector=function(group,buttons){if(group===undefined||null===group)return $.map(buttons,function(v){return v.inst});function process(input){var idx;if(Array.isArray(input))for(var i=0,ien=input.length;i<ien;i++)process(input[i]);else"string"==typeof input?-1!==input.indexOf(",")?process(input.split(",")):-1!==(idx=$.inArray(input.trim(),names))&&ret.push(buttons[idx].inst):"number"==typeof input?ret.push(buttons[input].inst):"object"==typeof input&&ret.push(input)}var ret=[],names=$.map(buttons,function(v){return v.name});return process(group),ret},Buttons.buttonSelector=function(insts,selector){for(var ret=[],nodeBuilder=function(a,buttons,baseIdx){for(var button,idx,i=0,ien=buttons.length;i<ien;i++)(button=buttons[i])&&(a.push({node:button.node,name:button.conf.name,idx:idx=baseIdx!==undefined?baseIdx+i:i+""}),button.buttons&&nodeBuilder(a,button.buttons,idx+"-"))},run=function(selector,inst){var buttons=[];nodeBuilder(buttons,inst.s.buttons);var nodes=$.map(buttons,function(v){return v.node});if(Array.isArray(selector)||selector instanceof $)for(i=0,ien=selector.length;i<ien;i++)run(selector[i],inst);else if(null===selector||selector===undefined||"*"===selector)for(i=0,ien=buttons.length;i<ien;i++)ret.push({inst:inst,node:buttons[i].node});else if("number"==typeof selector)inst.s.buttons[selector]&&ret.push({inst:inst,node:inst.s.buttons[selector].node});else if("string"==typeof selector)if(-1!==selector.indexOf(","))for(var a=selector.split(","),i=0,ien=a.length;i<ien;i++)run(a[i].trim(),inst);else if(selector.match(/^\d+(\-\d+)*$/)){var idx=$.map(buttons,function(v){return v.idx});ret.push({inst:inst,node:buttons[$.inArray(selector,idx)].node})}else if(-1!==selector.indexOf(":name")){var name=selector.replace(":name","");for(i=0,ien=buttons.length;i<ien;i++)buttons[i].name===name&&ret.push({inst:inst,node:buttons[i].node})}else $(nodes).filter(selector).each(function(){ret.push({inst:inst,node:this})});else"object"!=typeof selector||!selector.nodeName||-1!==(idx=$.inArray(selector,nodes))&&ret.push({inst:inst,node:nodes[idx]})},i=0,ien=insts.length;i<ien;i++){var inst=insts[i];run(selector,inst)}return ret},Buttons.stripData=function(str,config){return"string"!=typeof str||(str=(str=str.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")).replace(/<!\-\-.*?\-\->/g,""),config&&!config.stripHtml||(str=str.replace(/<[^>]*>/g,"")),config&&!config.trim||(str=str.replace(/^\s+|\s+$/g,"")),config&&!config.stripNewlines||(str=str.replace(/\n/g," ")),config&&!config.decodeEntities||(_exportTextarea.innerHTML=str,str=_exportTextarea.value)),str},Buttons.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:""},button:{tag:"button",className:"dt-button",active:"active",disabled:"disabled",spacerClass:""},buttonLiner:{tag:"span",className:""},split:{tag:"div",className:"dt-button-split"},splitWrapper:{tag:"div",className:"dt-btn-split-wrapper"},splitDropdown:{tag:"button",text:"&#x25BC;",className:"dt-btn-split-drop",align:"split-right",splitAlignClass:"dt-button-split-left"},splitDropdownButton:{tag:"button",className:"dt-btn-split-drop-button dt-button"},splitCollection:{tag:"div",className:"dt-button-split-collection"}}},Buttons.version="2.1.1",$.extend(_dtButtons,{collection:{text:function(dt){return dt.i18n("buttons.collection","Collection")},className:"buttons-collection",init:function(dt,button,config){button.attr("aria-expanded",!1)},action:function(e,dt,button,config){config._collection.parents("body").length?this.popover(!1,config):this.popover(config._collection,config)},attr:{"aria-haspopup":!0}},split:{text:function(dt){return dt.i18n("buttons.split","Split")},className:"buttons-split",init:function(dt,button,config){return button.attr("aria-expanded",!1)},action:function(e,dt,button,config){this.popover(config._collection,config)},attr:{"aria-haspopup":!0}},copy:function(dt,conf){if(_dtButtons.copyHtml5)return"copyHtml5"},csv:function(dt,conf){if(_dtButtons.csvHtml5&&_dtButtons.csvHtml5.available(dt,conf))return"csvHtml5"},excel:function(dt,conf){if(_dtButtons.excelHtml5&&_dtButtons.excelHtml5.available(dt,conf))return"excelHtml5"},pdf:function(dt,conf){if(_dtButtons.pdfHtml5&&_dtButtons.pdfHtml5.available(dt,conf))return"pdfHtml5"},pageLength:function(dt){var lengthMenu=dt.settings()[0].aLengthMenu,vals=[],lang=[];if(Array.isArray(lengthMenu[0]))vals=lengthMenu[0],lang=lengthMenu[1];else for(var i=0;i<lengthMenu.length;i++){var option=lengthMenu[i];$.isPlainObject(option)?(vals.push(option.value),lang.push(option.label)):(vals.push(option),lang.push(option))}return{extend:"collection",text:function(dt){return dt.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},dt.page.len())},className:"buttons-page-length",autoClose:!0,buttons:$.map(vals,function(val,i){return{text:lang[i],className:"button-page-length",action:function(e,dt){dt.page.len(val).draw()},init:function(dt,node,conf){function fn(){that.active(dt.page.len()===val)}var that=this;dt.on("length.dt"+conf.namespace,fn),fn()},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}}),init:function(dt,node,conf){var that=this;dt.on("length.dt"+conf.namespace,function(){that.text(conf.text)})},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}},spacer:{style:"empty",spacer:!0,text:function(dt){return dt.i18n("buttons.spacer","")}}}),DataTable.Api.register("buttons()",function(group,selector){selector===undefined&&(selector=group,group=undefined),this.selector.buttonGroup=group;var res=this.iterator(!0,"table",function(ctx){if(ctx._buttons)return Buttons.buttonSelector(Buttons.instanceSelector(group,ctx._buttons),selector)},!0);return res._groupSelector=group,res}),DataTable.Api.register("button()",function(group,buttons){buttons=this.buttons(group,buttons);return 1<buttons.length&&buttons.splice(1,buttons.length),buttons}),DataTable.Api.registerPlural("buttons().active()","button().active()",function(flag){return flag===undefined?this.map(function(set){return set.inst.active(set.node)}):this.each(function(set){set.inst.active(set.node,flag)})}),DataTable.Api.registerPlural("buttons().action()","button().action()",function(action){return action===undefined?this.map(function(set){return set.inst.action(set.node)}):this.each(function(set){set.inst.action(set.node,action)})}),DataTable.Api.registerPlural("buttons().collectionRebuild()","button().collectionRebuild()",function(buttons){return this.each(function(set){for(var i=0;i<buttons.length;i++)"object"==typeof buttons[i]&&(buttons[i].parentConf=set);set.inst.collectionRebuild(set.node,buttons)})}),DataTable.Api.register(["buttons().enable()","button().enable()"],function(flag){return this.each(function(set){set.inst.enable(set.node,flag)})}),DataTable.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(set){set.inst.disable(set.node)})}),DataTable.Api.register("button().index()",function(){var idx=null;return this.each(function(res){res=res.inst.index(res.node);null!==res&&(idx=res)}),idx}),DataTable.Api.registerPlural("buttons().nodes()","button().node()",function(){var jq=$();return $(this.each(function(set){jq=jq.add(set.inst.node(set.node))})),jq}),DataTable.Api.registerPlural("buttons().processing()","button().processing()",function(flag){return flag===undefined?this.map(function(set){return set.inst.processing(set.node)}):this.each(function(set){set.inst.processing(set.node,flag)})}),DataTable.Api.registerPlural("buttons().text()","button().text()",function(label){return label===undefined?this.map(function(set){return set.inst.text(set.node)}):this.each(function(set){set.inst.text(set.node,label)})}),DataTable.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(set){set.inst.node(set.node).trigger("click")})}),DataTable.Api.register("button().popover()",function(content,options){return this.map(function(set){return set.inst._popover(content,this.button(this[0].node),options)})}),DataTable.Api.register("buttons().containers()",function(){var jq=$(),groupSelector=this._groupSelector;return this.iterator(!0,"table",function(ctx){if(ctx._buttons)for(var insts=Buttons.instanceSelector(groupSelector,ctx._buttons),i=0,ien=insts.length;i<ien;i++)jq=jq.add(insts[i].container())}),jq}),DataTable.Api.register("buttons().container()",function(){return this.containers().eq(0)}),DataTable.Api.register("button().add()",function(idx,conf,draw){var inst=this.context;return!inst.length||(inst=Buttons.instanceSelector(this._groupSelector,inst[0]._buttons)).length&&inst[0].add(conf,idx,draw),this.button(this._groupSelector,idx)}),DataTable.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(inst){inst.destroy()}),this}),DataTable.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(set){set.inst.remove(set.node)}),this}),DataTable.Api.register("buttons.info()",function(title,message,time){var that=this;return!1===title?(this.off("destroy.btn-info"),_fadeOut($("#datatables_buttons_info"),400,function(){$(this).remove()}),clearTimeout(_infoTimer),_infoTimer=null):(_infoTimer&&clearTimeout(_infoTimer),$("#datatables_buttons_info").length&&$("#datatables_buttons_info").remove(),title=title?"<h2>"+title+"</h2>":"",_fadeIn($('<div id="datatables_buttons_info" class="dt-button-info"/>').html(title).append($("<div/>")["string"==typeof message?"html":"append"](message)).css("display","none").appendTo("body")),time!==undefined&&0!==time&&(_infoTimer=setTimeout(function(){that.buttons.info(!1)},time)),this.on("destroy.btn-info",function(){that.buttons.info(!1)})),this}),DataTable.Api.register("buttons.exportData()",function(options){if(this.context.length)return _exportData(new DataTable.Api(this.context[0]),options)}),DataTable.Api.register("buttons.exportInfo()",function(conf){return{filename:_filename(conf=conf||{}),title:_title(conf),messageTop:_message(this,conf.message||conf.messageTop,"top"),messageBottom:_message(this,conf.messageBottom,"bottom")}});var _filename=function(config){var filename;return(filename="function"==typeof(filename="*"===config.filename&&"*"!==config.title&&config.title!==undefined&&null!==config.title&&""!==config.title?config.title:config.filename)?filename():filename)===undefined||null===filename?null:(filename=(filename=-1!==filename.indexOf("*")?filename.replace("*",$("head > title").text()).trim():filename).replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""))+(_stringOrFunction(config.extension)||"")},_stringOrFunction=function(option){return null===option||option===undefined?null:"function"==typeof option?option():option},_title=function(title){title=_stringOrFunction(title.title);return null===title?null:-1!==title.indexOf("*")?title.replace("*",$("head > title").text()||"Exported data"):title},_message=function(caption,message,position){message=_stringOrFunction(message);if(null===message)return null;caption=$("caption",caption.table().container()).eq(0);return"*"!==message?message:caption.css("caption-side")!==position?null:caption.length?caption.text():""},_exportTextarea=$("<textarea/>")[0],_exportData=function(dt,selectedCells){var config=$.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(d){return Buttons.stripData(d,config)},footer:function(d){return Buttons.stripData(d,config)},body:function(d){return Buttons.stripData(d,config)}},customizeData:null},selectedCells),header=dt.columns(config.columns).indexes().map(function(idx){var el=dt.column(idx).header();return config.format.header(el.innerHTML,idx,el)}).toArray(),data=dt.table().footer()?dt.columns(config.columns).indexes().map(function(idx){var el=dt.column(idx).footer();return config.format.footer(el?el.innerHTML:"",idx,el)}).toArray():null,selectedCells=$.extend({},config.modifier);dt.select&&"function"==typeof dt.select.info&&selectedCells.selected===undefined&&dt.rows(config.rows,$.extend({selected:!0},selectedCells)).any()&&$.extend(selectedCells,{selected:!0});for(var selectedCells=dt.rows(config.rows,selectedCells).indexes().toArray(),selectedCells=dt.cells(selectedCells,config.columns),cells=selectedCells.render(config.orthogonal).toArray(),cellNodes=selectedCells.nodes().toArray(),columns=header.length,body=[],cellCounter=0,i=0,ien=0<columns?cells.length/columns:0;i<ien;i++){for(var row=[columns],j=0;j<columns;j++)row[j]=config.format.body(cells[cellCounter],i,j,cellNodes[cellCounter]),cellCounter++;body[i]=row}data={header:header,footer:data,body:body};return config.customizeData&&config.customizeData(data),data};function _init(api,opts){api=new DataTable.Api(api),opts=opts||api.init().buttons||DataTable.defaults.buttons;return new Buttons(api,opts).container()}return $.fn.dataTable.Buttons=Buttons,$.fn.DataTable.Buttons=Buttons,$(document).on("init.dt plugin-init.dt",function(opts,settings){"dt"!==opts.namespace||(opts=settings.oInit.buttons||DataTable.defaults.buttons)&&!settings._buttons&&new Buttons(settings,opts).container()}),DataTable.ext.feature.push({fnInit:_init,cFeature:"B"}),DataTable.ext.features&&DataTable.ext.features.register("buttons",_init),Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$,jszip,pdfmake){return root=root||window,($=!$||!$.fn.dataTable?require("datatables.net")(root,$).$:$).fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document,jszip,pdfmake)}:factory(jQuery,window,document)}(function($,window,document,jszip,pdfmake,undefined){"use strict";var DataTable=$.fn.dataTable;function _jsZip(){return jszip||window.JSZip}function _pdfMake(){return pdfmake||window.pdfMake}DataTable.Buttons.pdfMake=function(_){if(!_)return _pdfMake();pdfmake=_},DataTable.Buttons.jszip=function(_){if(!_)return _jsZip();jszip=_};var _saveAs=function(view){if(!(void 0===view||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var FS_proto=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=FS_proto.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,is_safari=/constructor/i.test(view.HTMLElement)||view.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},arbitrary_revoke_timeout=4e4,revoke=function(file){setTimeout(function(){"string"==typeof file?get_URL().revokeObjectURL(file):file.remove()},arbitrary_revoke_timeout)},auto_bom=function(blob){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)?new Blob([String.fromCharCode(65279),blob],{type:blob.type}):blob},FileSaver=function(blob,name,no_auto_bom){no_auto_bom||(blob=auto_bom(blob));var object_url,filesaver=this,force="application/octet-stream"===blob.type,dispatch_all=function(){!function(filesaver,event_types,event){for(var i=(event_types=[].concat(event_types)).length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}(filesaver,"writestart progress write writeend".split(" "))};if(filesaver.readyState=filesaver.INIT,can_use_save_link)return object_url=get_URL().createObjectURL(blob),void setTimeout(function(){var node,event;save_link.href=object_url,save_link.download=name,node=save_link,event=new MouseEvent("click"),node.dispatchEvent(event),dispatch_all(),revoke(object_url),filesaver.readyState=filesaver.DONE});!function(){if((is_chrome_ios||force&&is_safari)&&view.FileReader){var reader=new FileReader;return reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,"data:attachment/file;");view.open(url,"_blank")||(view.location.href=url),url=undefined,filesaver.readyState=filesaver.DONE,dispatch_all()},reader.readAsDataURL(blob),filesaver.readyState=filesaver.INIT}object_url=object_url||get_URL().createObjectURL(blob),!force&&view.open(object_url,"_blank")||(view.location.href=object_url),filesaver.readyState=filesaver.DONE,dispatch_all(),revoke(object_url)}()},FS_proto=FileSaver.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(blob,name,no_auto_bom){return name=name||blob.name||"download",no_auto_bom||(blob=auto_bom(blob)),navigator.msSaveOrOpenBlob(blob,name)}:(FS_proto.abort=function(){},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom)})}}("undefined"!=typeof self&&self||void 0!==window&&window||this.content);DataTable.fileSave=_saveAs;function _sheetname(config){var sheetName="Sheet1";return sheetName=config.sheetName?config.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""):sheetName}function _exportData(header,footer){for(var newLine=_newLine(footer),data=header.buttons.exportData(footer.exportOptions),boundary=footer.fieldBoundary,separator=footer.fieldSeparator,reBoundary=new RegExp(boundary,"g"),escapeChar=footer.escapeChar!==undefined?footer.escapeChar:"\\",join=function(a){for(var s="",i=0,ien=a.length;i<ien;i++)0<i&&(s+=separator),s+=boundary?boundary+(""+a[i]).replace(reBoundary,escapeChar+boundary)+boundary:a[i];return s},header=footer.header?join(data.header)+newLine:"",footer=footer.footer&&data.footer?newLine+join(data.footer):"",body=[],i=0,ien=data.body.length;i<ien;i++)body.push(join(data.body[i]));return{str:header+body.join(newLine)+footer,rows:body.length}}function _isDuffSafari(){if(-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")){var version=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);return!!(version&&1<version.length&&+version[1]<603.1)}}var _newLine=function(config){return config.newline||(navigator.userAgent.match(/Windows/)?"\r\n":"\n")};function createCellPos(n){for(var ordA="A".charCodeAt(0),len="Z".charCodeAt(0)-ordA+1,s="";0<=n;)s=String.fromCharCode(n%len+ordA)+s,n=Math.floor(n/len)-1;return s}try{var _ieExcel,_serialiser=new XMLSerializer}catch(t){}function _createNode(doc,nodeName,opts){var tempNode=doc.createElement(nodeName);return opts&&(opts.attr&&$(tempNode).attr(opts.attr),opts.children&&$.each(opts.children,function(key,value){tempNode.appendChild(value)}),null!==opts.text&&opts.text!==undefined&&tempNode.appendChild(doc.createTextNode(opts.text))),tempNode}var excelStrings={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets><definedNames/></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/><mergeCells count="0"/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="68"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="14" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},_excelSpecials=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(d){return d/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(d){return d/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(d){return-1*d.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(d){return-1*d.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64},{match:/^[\d]{4}\-[\d]{2}\-[\d]{2}$/,style:67,fmt:function(d){return Math.round(25569+Date.parse(d)/864e5)}}];return DataTable.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(dt){return dt.i18n("buttons.copy","Copy")},action:function(e,dt,button,config){this.processing(!0);var that=this,exportData=_exportData(dt,config),info=dt.buttons.exportInfo(config),newline=_newLine(config),textarea=exportData.str,message=$("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});info.title&&(textarea=info.title+newline+newline+textarea),info.messageTop&&(textarea=info.messageTop+newline+newline+textarea),info.messageBottom&&(textarea=textarea+newline+newline+info.messageBottom),config.customize&&(textarea=config.customize(textarea,config,dt));textarea=$("<textarea readonly/>").val(textarea).appendTo(message);if(document.queryCommandSupported("copy")){message.appendTo(dt.table().container()),textarea[0].focus(),textarea[0].select();try{var successful=document.execCommand("copy");if(message.remove(),successful)return dt.buttons.info(dt.i18n("buttons.copyTitle","Copy to clipboard"),dt.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},exportData.rows),2e3),void this.processing(!1)}catch(t){}}message=$("<span>"+dt.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(message);dt.buttons.info(dt.i18n("buttons.copyTitle","Copy to clipboard"),message,0),textarea[0].focus(),textarea[0].select();function close(){container.off("click.buttons-copy"),$(document).off(".buttons-copy"),dt.buttons.info(!1)}var container=$(message).closest(".dt-button-info");container.on("click.buttons-copy",close),$(document).on("keydown.buttons-copy",function(e){27===e.keyCode&&(close(),that.processing(!1))}).on("copy.buttons-copy cut.buttons-copy",function(){close(),that.processing(!1)})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1,title:"*",messageTop:"*",messageBottom:"*"},DataTable.ext.buttons.csvHtml5={bom:!1,className:"buttons-csv buttons-html5",available:function(){return window.FileReader!==undefined&&window.Blob},text:function(dt){return dt.i18n("buttons.csv","CSV")},action:function(e,dt,button,config){this.processing(!0);var output=_exportData(dt,config).str,info=dt.buttons.exportInfo(config),charset=config.charset;config.customize&&(output=config.customize(output,config,dt)),charset=!1!==charset?(charset=charset||(document.characterSet||document.charset))&&";charset="+charset:"",config.bom&&(output=String.fromCharCode(65279)+output),_saveAs(new Blob([output],{type:"text/csv"+charset}),info.filename,!0),this.processing(!1)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1},DataTable.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return window.FileReader!==undefined&&_jsZip()!==undefined&&!_isDuffSafari()&&_serialiser},text:function(dt){return dt.i18n("buttons.excel","Excel")},action:function(e,zipConfig,button,config){this.processing(!0);function addRow(row){rowNode=_createNode(rels,"row",{attr:{r:currentRow=rowPos+1}});for(var i=0,ien=row.length;i<ien;i++){var cellId=createCellPos(i)+""+currentRow,cell=null;if(null===row[i]||row[i]===undefined||""===row[i]){if(!0!==config.createEmptyCells)continue;row[i]=""}var text=row[i];row[i]="function"==typeof row[i].trim?row[i].trim():row[i];for(var j=0,jen=_excelSpecials.length;j<jen;j++){var special=_excelSpecials[j];if(row[i].match&&!row[i].match(/^0\d+/)&&row[i].match(special.match)){var val=row[i].replace(/[^\d\.\-]/g,"");special.fmt&&(val=special.fmt(val)),cell=_createNode(rels,"c",{attr:{r:cellId,s:special.style},children:[_createNode(rels,"v",{text:val})]});break}}cell=cell||("number"==typeof row[i]||row[i].match&&row[i].match(/^-?\d+(\.\d+)?([eE]\-?\d+)?$/)&&!row[i].match(/^0\d+/)?_createNode(rels,"c",{attr:{t:"n",r:cellId},children:[_createNode(rels,"v",{text:row[i]})]}):(text=text.replace?text.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""):text,_createNode(rels,"c",{attr:{t:"inlineStr",r:cellId},children:{row:_createNode(rels,"is",{children:{row:_createNode(rels,"t",{text:text,attr:{"xml:space":"preserve"}})}})}}))),rowNode.appendChild(cell)}relsGet.appendChild(rowNode),rowPos++}var currentRow,rowNode,that=this,rowPos=0,zip=function(str){str=excelStrings[str];return $.parseXML(str)},rels=zip("xl/worksheets/sheet1.xml"),relsGet=rels.getElementsByTagName("sheetData")[0],xlsx={_rels:{".rels":zip("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":zip("xl/_rels/workbook.xml.rels")},"workbook.xml":zip("xl/workbook.xml"),"styles.xml":zip("xl/styles.xml"),worksheets:{"sheet1.xml":rels}},"[Content_Types].xml":zip("[Content_Types].xml")},data=zipConfig.buttons.exportData(config.exportOptions);config.customizeData&&config.customizeData(data);var workbook=function(row,colspan){var mergeCells=$("mergeCells",rels);mergeCells[0].appendChild(_createNode(rels,"mergeCell",{attr:{ref:"A"+row+":"+createCellPos(colspan)+row}})),mergeCells.attr("count",parseFloat(mergeCells.attr("count"))+1),$("row:eq("+(row-1)+") c",rels).attr("s","51")},exportInfo=zipConfig.buttons.exportInfo(config);exportInfo.title&&(addRow([exportInfo.title]),workbook(rowPos,data.header.length-1)),exportInfo.messageTop&&(addRow([exportInfo.messageTop]),workbook(rowPos,data.header.length-1)),config.header&&(addRow(data.header),$("row:last c",rels).attr("s","2"));for(var dataStartRow=rowPos,n=0,ie=data.body.length;n<ie;n++)addRow(data.body[n]);zip=rowPos,config.footer&&data.footer&&(addRow(data.footer),$("row:last c",rels).attr("s","2")),exportInfo.messageBottom&&(addRow([exportInfo.messageBottom]),workbook(rowPos,data.header.length-1));var cols=_createNode(rels,"cols");$("worksheet",rels).prepend(cols);for(var i=0,ien=data.header.length;i<ien;i++)cols.appendChild(_createNode(rels,"col",{attr:{min:i+1,max:i+1,width:function(data,col){var max=data.header[col].length;data.footer&&data.footer[col].length>max&&(max=data.footer[col].length);for(var i=0,ien=data.body.length;i<ien;i++){var len,lineSplit=data.body[i][col];if(40<(max=max<(len=-1!==(len=null!==lineSplit&&lineSplit!==undefined?lineSplit.toString():"").indexOf("\n")?((lineSplit=len.split("\n")).sort(function(a,b){return b.length-a.length}),lineSplit[0].length):len.length)?len:max))return 54}return 6<(max*=1.35)?max:6}(data,i),customWidth:1}}));workbook=xlsx.xl["workbook.xml"];$("sheets sheet",workbook).attr("name",_sheetname(config)),config.autoFilter&&($("mergeCells",rels).before(_createNode(rels,"autoFilter",{attr:{ref:"A"+dataStartRow+":"+createCellPos(data.header.length-1)+zip}})),$("definedNames",workbook).append(_createNode(workbook,"definedName",{attr:{name:"_xlnm._FilterDatabase",localSheetId:"0",hidden:1},text:_sheetname(config)+"!$A$"+dataStartRow+":"+createCellPos(data.header.length-1)+zip}))),config.customize&&config.customize(xlsx,config,zipConfig),0===$("mergeCells",rels).children().length&&$("mergeCells",rels).remove();zip=new(_jsZip()),zipConfig={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};!function _addToZip(zip,obj){_ieExcel===undefined&&(_ieExcel=-1===_serialiser.serializeToString((new window.DOMParser).parseFromString(excelStrings["xl/worksheets/sheet1.xml"],"text/xml")).indexOf("xmlns:r")),$.each(obj,function(name,val){if($.isPlainObject(val))_addToZip(zip.folder(name),val);else{if(_ieExcel){for(var ien,worksheet=val.childNodes[0],attrs=[],i=worksheet.attributes.length-1;0<=i;i--){var attrName=worksheet.attributes[i].nodeName,attrValue=worksheet.attributes[i].nodeValue;-1!==attrName.indexOf(":")&&(attrs.push({name:attrName,value:attrValue}),worksheet.removeAttribute(attrName))}for(i=0,ien=attrs.length;i<ien;i++){var attr=val.createAttribute(attrs[i].name.replace(":","_dt_b_namespace_token_"));attr.value=attrs[i].value,worksheet.setAttributeNode(attr)}}var str=_serialiser.serializeToString(val),str=(str=_ieExcel?(str=(str=-1===str.indexOf("<?xml")?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str:str).replace(/_dt_b_namespace_token_/g,":")).replace(/xmlns:NS[\d]+="" NS[\d]+:/g,""):str).replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,"<$1 $2>");zip.file(name,str)}})}(zip,xlsx),zip.generateAsync?zip.generateAsync(zipConfig).then(function(blob){_saveAs(blob,exportInfo.filename),that.processing(!1)}):(_saveAs(zip.generate(zipConfig),exportInfo.filename),this.processing(!1))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1,title:"*",messageTop:"*",messageBottom:"*",createEmptyCells:!1,autoFilter:!1,sheetName:""},DataTable.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return window.FileReader!==undefined&&_pdfMake()},text:function(dt){return dt.i18n("buttons.pdf","PDF")},action:function(e,dt,button,config){this.processing(!0);var data=dt.buttons.exportData(config.exportOptions),info=dt.buttons.exportInfo(config),rows=[];config.header&&rows.push($.map(data.header,function(d){return{text:"string"==typeof d?d:d+"",style:"tableHeader"}}));for(var i=0,ien=data.body.length;i<ien;i++)rows.push($.map(data.body[i],function(d){return{text:"string"==typeof(d=null===d||d===undefined?"":d)?d:d+"",style:i%2?"tableBodyEven":"tableBodyOdd"}}));config.footer&&data.footer&&rows.push($.map(data.footer,function(d){return{text:"string"==typeof d?d:d+"",style:"tableFooter"}}));var pdf={pageSize:config.pageSize,pageOrientation:config.orientation,content:[{table:{headerRows:1,body:rows},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};info.messageTop&&pdf.content.unshift({text:info.messageTop,style:"message",margin:[0,0,0,12]}),info.messageBottom&&pdf.content.push({text:info.messageBottom,style:"message",margin:[0,0,0,12]}),info.title&&pdf.content.unshift({text:info.title,style:"title",margin:[0,0,0,12]}),config.customize&&config.customize(pdf,config,dt);pdf=_pdfMake().createPdf(pdf);"open"!==config.download||_isDuffSafari()?pdf.download(info.filename):pdf.open(),this.processing(!1)},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,messageTop:"*",messageBottom:"*",customize:null,download:"download"},DataTable.Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,($=!$||!$.fn.dataTable?require("datatables.net")(root,$).$:$).fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";function _relToAbs(linkHost){return _link.href=linkHost,-1===(linkHost=_link.host).indexOf("/")&&0!==_link.pathname.indexOf("/")&&(linkHost+="/"),_link.protocol+"//"+linkHost+_link.pathname+_link.search}var DataTable=$.fn.dataTable,_link=document.createElement("a");return DataTable.ext.buttons.print={className:"buttons-print",text:function(dt){return dt.i18n("buttons.print","Print")},action:function(e,dt,button,config){function addRow(d,tag){for(var str="<tr>",i=0,ien=d.length;i<ien;i++){var dataOut=null===d[i]||d[i]===undefined?"":d[i];str+="<"+tag+" "+(columnClasses[i]?'class="'+columnClasses[i]+'"':"")+">"+dataOut+"</"+tag+">"}return str+"</tr>"}var data=dt.buttons.exportData($.extend({decodeEntities:!1},config.exportOptions)),autoPrint=dt.buttons.exportInfo(config),columnClasses=dt.columns(config.exportOptions.columns).flatten().map(function(idx){return dt.settings()[0].aoColumns[dt.column(idx).index()].sClass}).toArray(),html='<table class="'+dt.table().node().className+'">';config.header&&(html+="<thead>"+addRow(data.header,"th")+"</thead>"),html+="<tbody>";for(var i=0,ien=data.body.length;i<ien;i++)html+=addRow(data.body[i],"td");html+="</tbody>",config.footer&&data.footer&&(html+="<tfoot>"+addRow(data.footer,"th")+"</tfoot>"),html+="</table>";var win=window.open("","");if(win){win.document.close();var head="<title>"+autoPrint.title+"</title>";$("style, link").each(function(){head+=function(clone){clone=$(clone).clone()[0];return"link"===clone.nodeName.toLowerCase()&&(clone.href=_relToAbs(clone.href)),clone.outerHTML}(this)});try{win.document.head.innerHTML=head}catch(e){$(win.document.head).html(head)}win.document.body.innerHTML="<h1>"+autoPrint.title+"</h1><div>"+(autoPrint.messageTop||"")+"</div>"+html+"<div>"+(autoPrint.messageBottom||"")+"</div>",$(win.document.body).addClass("dt-print-view"),$("img",win.document.body).each(function(i,img){img.setAttribute("src",_relToAbs(img.getAttribute("src")))}),config.customize&&config.customize(win,config,dt);autoPrint=function(){config.autoPrint&&(win.print(),win.close())};navigator.userAgent.match(/Trident\/\d.\d/)?autoPrint():win.setTimeout(autoPrint,1e3)}else dt.buttons.info(dt.i18n("buttons.printErrorTitle","Unable to open print view"),dt.i18n("buttons.printErrorMsg","Please allow popups in your browser for this site to be able to view the print view."),5e3)},title:"*",messageTop:"*",messageBottom:"*",exportOptions:{},header:!0,footer:!1,autoPrint:!0,customize:null},DataTable.Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,($=!$||!$.fn.dataTable?require("datatables.net")(root,$).$:$).fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,0,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable;return $.extend(DataTable.ext.buttons,{colvis:function(dt,conf){var node=null,buttonConf={extend:"collection",init:function(dt,n){node=n},text:function(dt){return dt.i18n("buttons.colvis","Column visibility")},className:"buttons-colvis",buttons:[{extend:"columnsToggle",columns:conf.columns,columnText:conf.columnText}]};return dt.on("column-reorder.dt"+conf.namespace,function(e,settings,details){dt.button(null,dt.button(null,node).node()).collectionRebuild([{extend:"columnsToggle",columns:conf.columns,columnText:conf.columnText}])}),buttonConf},columnsToggle:function(dt,conf){return dt.columns(conf.columns).indexes().map(function(idx){return{extend:"columnToggle",columns:idx,columnText:conf.columnText}}).toArray()},columnToggle:function(dt,conf){return{extend:"columnVisibility",columns:conf.columns,columnText:conf.columnText}},columnsVisibility:function(dt,conf){return dt.columns(conf.columns).indexes().map(function(idx){return{extend:"columnVisibility",columns:idx,visibility:conf.visibility,columnText:conf.columnText}}).toArray()},columnVisibility:{columns:undefined,text:function(dt,button,conf){return conf._columnText(dt,conf)},className:"buttons-columnVisibility",action:function(e,curr,button,conf){var col=curr.columns(conf.columns),curr=col.visible();col.visible(conf.visibility!==undefined?conf.visibility:!(curr.length&&curr[0]))},init:function(dt,button,conf){var that=this;button.attr("data-cv-idx",conf.columns),dt.on("column-visibility.dt"+conf.namespace,function(e,settings){settings.bDestroying||settings.nTable!=dt.settings()[0].nTable||that.active(dt.column(conf.columns).visible())}).on("column-reorder.dt"+conf.namespace,function(e,settings,details){conf.destroying||1===dt.columns(conf.columns).count()&&(that.text(conf._columnText(dt,conf)),that.active(dt.column(conf.columns).visible()))}),this.active(dt.column(conf.columns).visible())},destroy:function(dt,button,conf){dt.off("column-visibility.dt"+conf.namespace).off("column-reorder.dt"+conf.namespace)},_columnText:function(dt,conf){var idx=dt.column(conf.columns).index(),title=dt.settings()[0].aoColumns[idx].sTitle;return title=(title=title||dt.column(idx).header().innerHTML).replace(/\n/g," ").replace(/<br\s*\/?>/gi," ").replace(/<select(.*?)<\/select>/g,"").replace(/<!\-\-.*?\-\->/g,"").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),conf.columnText?conf.columnText(dt,idx,title):title}},colvisRestore:{className:"buttons-colvisRestore",text:function(dt){return dt.i18n("buttons.colvisRestore","Restore visibility")},init:function(dt,button,conf){conf._visOriginal=dt.columns().indexes().map(function(idx){return dt.column(idx).visible()}).toArray()},action:function(e,dt,button,conf){dt.columns().every(function(idx){idx=dt.colReorder&&dt.colReorder.transpose?dt.colReorder.transpose(idx,"toOriginal"):idx;this.visible(conf._visOriginal[idx])})}},colvisGroup:{className:"buttons-colvisGroup",action:function(e,dt,button,conf){dt.columns(conf.show).visible(!0,!1),dt.columns(conf.hide).visible(!1,!1),dt.columns.adjust()},show:[],hide:[]}}),DataTable.Buttons});