window.gvDTResponsive=window.gvDTResponsive||{},window.gvDTFixedHeaderColumns=window.gvDTFixedHeaderColumns||{},function($){$.fn.dataTable.ext.errMode="throw";var gvDataTables={tablesData:{},init:function(){$(".gv-datatables").each(function(i,e){var options=window.gvDTglobals[i],viewId=$(this).attr("data-viewid");gvDataTables.tablesData[viewId]=options.ajax.data,options.buttons=gvDataTables.setButtons(options),options.drawCallback=function(data){window.gvEntryNotes&&window.gvEntryNotes.init(),data.json.inlineEditTemplatesData&&$(window).trigger("gravityview-inline-edit/extend-template-data",data.json.inlineEditTemplatesData),$(window).trigger("gravityview-inline-edit/init")},options.ajax.data=function(e){return $.extend({},e,gvDataTables.tablesData[viewId])},i<gvDTFixedHeaderColumns.length&&gvDTFixedHeaderColumns.hasOwnProperty(i)&&("1"===gvDTFixedHeaderColumns[i].fixedheader.toString()&&(options.fixedHeader=!0),"1"===gvDTFixedHeaderColumns[i].fixedcolumns.toString()&&(options.fixedColumns=!0)),i<gvDTResponsive.length&&gvDTResponsive.hasOwnProperty(i)&&"1"===gvDTResponsive[i].responsive.toString()&&("1"===gvDTResponsive[i].hide_empty.toString()?options.responsive={details:{renderer:gvDataTables.customResponsiveRowRenderer}}:options.responsive=!0);var table=$(this).DataTable(options);options.updateInterval&&0<options.updateInterval&&setInterval(function(){table.ajax.reload()},+options.updateInterval),table.on("draw.dt",function(e,settings){new $.fn.dataTable.Api(settings).column(0).data().length&&$(e.target).parents(".gv-container-no-results").removeClass("gv-container-no-results").siblings(".gv-widgets-no-results").removeClass("gv-widgets-no-results"),$(window).trigger("gravityview-datatables/event/draw",{e:e,settings:settings})}).on("preXhr.dt",function(e,settings,data){$(window).trigger("gravityview-datatables/event/preXhr",{e:e,settings:settings,data:data})}).on("xhr.dt",function(e,settings,json,xhr){$(window).trigger("gravityview-datatables/event/xhr",{e:e,settings:settings,json:json,xhr:xhr})}).on("responsive-display",function(e,datatable,row,showHide,update){var visible_divs,div_attr;$(window).trigger("gravityview-datatables/event/responsive"),0<(visible_divs=$(this).find("td:visible .gravityview-fancybox")).length&&visible_divs.each(function(i,e){(div_attr=$(this).attr("data-fancybox"))&&-1===div_attr.indexOf("mobile")&&(div_attr+="-mobile",$(this).attr("data-fancybox",div_attr))})})})},setButtons:function(options){var buttons=[];return options&&options.buttons&&0<options.buttons.length&&options.buttons.forEach(function(button,i){"print"===button.extend?buttons[i]=$.extend(!0,{},gvDataTables.buttonCommon,gvDataTables.buttonCustomizePrint,button):buttons[i]=$.extend(!0,{},gvDataTables.buttonCommon,button)}),buttons},buttonCommon:{exportOptions:{format:{body:function(newValue,column,row){return 0===newValue.length?newValue:(newValue=newValue.replace(/\n/g," "),newValue=$("<span>"+newValue+"</span>").find("li").after("; ").end().find("img").replaceWith(function(){return $(this).attr("alt")}).end().find(".dashicons.dashicons-yes").replaceWith(function(){return"&#10004;"}).end().find("br").replaceWith(" ").end().find(".map-it-link").remove().end().text())}}}},buttonCustomizePrint:{customize:function(win){$(win.document.body).find("table").addClass("compact").css("font-size","inherit").css("table-layout","auto")}},customResponsiveRowRenderer:function(api,rowIdx){var data=api.cells(rowIdx,":hidden").eq(0).map(function(cellData){var header=$(api.column(cellData.column).header());if(header.hasClass("control")||header.hasClass("never"))return"";var idx=api.cell(cellData).index();if(0===api.cell(cellData).data().length)return"";cellData=api.settings()[0],cellData=cellData.oApi._fnGetCellData(cellData,idx.row,idx.column,"display");return'<li data-dtr-index="'+idx.column+'"><span class="dtr-title">'+header.text()+':</span> <span class="dtr-data">'+cellData+"</span></li>"}).toArray().join("");return!!data&&$('<ul data-dtr-index="'+rowIdx+'"/>').append(data)}};$(document).ready(function(){gvDataTables.init(),$(".gv-search-clear").off().on("click",function(e){var $form=$(this).parents("form"),viewId=$form.attr("data-viewid"),$table=$("#gv-datatables-"+viewId).find(".dataTable").attr("id"),tableData=gvDataTables.tablesData?gvDataTables.tablesData[viewId]:null,isSearch=$form.hasClass("gv-is-search");if($table&&$.fn.DataTable.isDataTable("#"+$table)){e.preventDefault(),e.stopImmediatePropagation();$table=$("#"+$table).DataTable();if(isSearch&&$form.serialize()!==$form.attr("data-state")){for(var formData={},serializedData=$form.attr("data-state").split("&"),i=0;i<serializedData.length;i++){var item=serializedData[i].split("=");formData[decodeURIComponent(item[0])]=decodeURIComponent(item[1])}return $.each(formData,function(name,value){$form.find('[name="'+name+'"]').val(value)}),void $(".gv-search-clear",$form).text(gvGlobals.clear)}$('input[type="search"], input:text, input:password, input:file, select, textarea',$form).val(""),$("input:checkbox, input:radio",$form).removeAttr("checked").removeAttr("selected"),$form.serialize()!==$form.attr("data-state")&&(tableData.getData=!1,gvDataTables.tablesData[viewId]=tableData,window.history.pushState(null,null,window.location.pathname),$form.removeClass("gv-is-search"),$form.attr("data-state",$form.serialize()),$table.ajax.reload()),$(this).hide(100)}}),$(".gv-widget-search").on("submit",function(tableData){tableData.preventDefault();var getData={},viewId=$(this).attr("data-viewid"),$container=$("#gv-datatables-"+viewId),$table=(0<$container.find(".DTFC_ScrollWrapper").length?$container.find(".dataTables_scrollBody .gv-datatables"):$container.find(".gv-datatables")).DataTable(),tableData=gvDataTables.tablesData?gvDataTables.tablesData[viewId]:null,inputs=$(this).serializeArray().filter(function(k){return""!==$.trim(k.value)});if($(this).serialize()!==$(this).attr("data-state"))if($(this).attr("data-state",$(this).serialize()),tableData){+tableData.hideUntilSearched&&$table.on("draw.dt",function(){$container.toggleClass("hidden",inputs.length<=1)});for(var i=0;i<inputs.length;i++){var name=inputs[i].name,value=inputs[i].value,matches=name.match(/(.*?)\[(.*)\]/);matches?(getData[matches[1]]||(matches[2]?getData[matches[1]]={}:getData[matches[1]]=[]),matches[2]?getData[matches[1]][matches[2]]=value:getData[matches[1]].push(value)):getData[name]=value}tableData.search={value:""},tableData.getData=1<Object.keys(getData).length&&JSON.stringify(getData),tableData.setUrlOnSearch&&window.history.pushState(null,null,tableData.getData?"?"+$(this).serialize():window.location.pathname),gvDataTables.tablesData[viewId]=tableData,$table.ajax.reload(),$(this).addClass("gv-is-search").attr("data-state",$(this).serialize()).trigger("keyup"),$(".gv-search-clear",$(this)).text(gvGlobals.clear)}else this.submit()})})}(jQuery);